<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>DateMagician Configuration</title>
</head>
<body>
    <div data-role="page" class="DateMagicianConfigurationPage">
        <form id="DateMagicianConfigurationForm">
            <ul>
                <li>
                    <label for="chkIsEnabled">
                        enable DateMagician
                    </label>
                    <input id="chkIsEnabled" name="chkIsEnabled" type="checkbox" value="isEnabled" />
                </li>
            </ul>
            <button id="btnSubmit" type="submit"><span>Save</span></button>
        </form>
    </div>
    <script type="text/javascript">
        var DateMagicianConfigurationPage =
        {
            pluginUniqueId: "726D639F-6518-49C1-B447-BEB1FCC9F263",
            virtualFolders: [],
            physicalFolders: [],
            loadConfiguration: function () {
                Dashboard.showLoadingMsg();
                ApiClient.getPluginConfiguration(DateMagicianConfigurationPage.pluginUniqueId).then(function (config) {
                    var page = $.mobile.activePage;
                    $('#chkIsEnabled', page).checked(config.isEnabled).checkbox("refresh");
                    Dashboard.hideLoadingMsg();
                });
            },
            saveConfiguration: function () {
                Dashboard.showLoadingMsg();
                var page = $.mobile.activePage;
                ApiClient.getPluginConfiguration(DateMagicianConfigurationPage.pluginUniqueId).then(function (config) {
                    config.isEnabled = $('#chkIsEnabled').prop('checked');
                    ApiClient.updatePluginConfiguration(DateMagicianConfigurationPage.pluginUniqueId, config).then(function (result) {
                        Dashboard.processPluginConfigurationUpdateResult(result);
                    });
                });
            },
        };
        $('#DateMagicianConfigurationPage').on('pageshow', function () {
            DateMagicianConfigurationPage.loadConfiguration();
        });
        $('#DateMagicianConfigurationForm').on('submit', function () {
            DateMagicianConfigurationPage.saveConfiguration();
            return false;
        });
    </script>
</body>
</html>